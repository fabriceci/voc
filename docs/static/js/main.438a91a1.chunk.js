(this["webpackJsonpilm-vocabulary-es"]=this["webpackJsonpilm-vocabulary-es"]||[]).push([[0],{211:function(e,t,n){},262:function(e,t){},264:function(e,t){},273:function(e,t){},275:function(e,t){},301:function(e,t){},302:function(e,t){},307:function(e,t){},309:function(e,t){},333:function(e,t){},397:function(e,t,n){"use strict";n.r(t);var r=n(0),c=n(9),s=n.n(c),a=n(204),i=n.n(a),l=(n(211),n(7)),u=n.n(l),o=n(15),j=n(26),d=n(68),f=n(205),b=[],h=[],m=function(e,t){return 0===t?0:Math.round(t/e*100*100)/100},O=function(e){return e?e.replaceAll("\xa1","").replaceAll("!","").replaceAll("\xbf","").replaceAll("?","").replaceAll(".","").replaceAll("\u2026","").replace(/\s\s+/g," ").trim().toLowerCase():""},p=function(e){return O(e).normalize("NFD").replace(/[\u0300-\u036f]/g,"")};function v(){return x.apply(this,arguments)}function x(){return(x=Object(d.a)(u.a.mark((function e(){var t,n,r,c,s,a,i,l,o,d=arguments;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=d.length>0&&void 0!==d[0]&&d[0],(n=JSON.parse(localStorage.getItem("words")))&&(r=localStorage.getItem("lastsync"),(c=new Date).setDate(c.getDate()-1),(!r||parseInt(r)<c.getTime())&&(n=null)),n&&!t){e.next=19;break}return(s=new f.GoogleSpreadsheet("1lA849BH1mhhAlnmhamfNnkXQVGJmEz_XpD5Fqbco5m0")).useApiKey("AIzaSyB3fhuMVnaW77F8ZiDu_mo_xJKdKzQo6tU"),e.next=8,s.loadInfo();case 8:return a=s.sheetsByIndex[0],e.next=11,a.getRows();case 11:i=e.sent,l=i.map((function(e){return{fr:e.fr?e.fr.trim():void 0,es:e.es?[e.es.trim()]:[],type:e.type?e.type.trim():void 0,module:e.module?e.module.trim():void 0,subject:e.sujet?e.sujet.trim():void 0,minimum:e.minimum}})),n=[],o=[],l.forEach((function(e){if(e.fr){var t,r,c=n.findIndex((function(t){return t.fr===e.fr}));if(-1===c)n.push(e);else if(!(t=n[c].es).includes.apply(t,Object(j.a)(e.es)))(r=n[c].es).push.apply(r,Object(j.a)(e.es));e.module&&!o.includes(e.module)&&o.push(e.module)}})),localStorage.setItem("words",JSON.stringify(n)),localStorage.setItem("modules",JSON.stringify(o)),localStorage.setItem("lastsync",JSON.stringify((new Date).getTime()));case 19:h=Object(j.a)(n),b=Object(j.a)(JSON.parse(localStorage.getItem("modules")));case 21:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var g=function(){var e=JSON.parse(localStorage.getItem("status"));return e?new Map(e):new Map},y=function(e,t){var n=g();if(n.has(e)){var r=n.get(e);r.attemps+=1,1===t?r.success+=1:r.error+=1,n.set(e,r)}else n.set(e,{attemps:1,success:1===t?1:0,error:-1===t?1:0});localStorage.setItem("status",JSON.stringify(Object(j.a)(n)))};var k=function(){var e=Object(c.useState)([]),t=Object(o.a)(e,2),n=t[0],s=t[1],a=Object(c.useState)(0),i=Object(o.a)(a,2),l=i[0],f=i[1],x=Object(c.useState)(!0),k=Object(o.a)(x,2),S=k[0],N=k[1],w=Object(c.useState)(!0),C=Object(o.a)(w,2),I=C[0],A=C[1],E=Object(c.useState)(0),J=Object(o.a)(E,2),D=J[0],M=J[1],V=Object(c.useState)(""),F=Object(o.a)(V,2),z=F[0],B=F[1],K=Object(c.useState)(!1),L=Object(o.a)(K,2),P=L[0],R=L[1],T=Object(c.useState)(!1),_=Object(o.a)(T,2),q=_[0],G=_[1],Q=Object(c.useState)("all"),U=Object(o.a)(Q,2),W=U[0],X=U[1],H=Object(c.useState)("error"),Z=Object(o.a)(H,2),Y=Z[0],$=Z[1],ee=Object(c.useState)(!1),te=Object(o.a)(ee,2),ne=te[0],re=te[1],ce=Object(c.useState)(!0),se=Object(o.a)(ce,2),ae=se[0],ie=se[1],le=Object(c.useRef)(null),ue=function(){var e=Object(d.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s([]),localStorage.removeItem("words"),localStorage.removeItem("modules"),e.next=5,v(!0);case 5:le&&le.current&&le.current.focus(),X("all"),$("error"),de(),ie(!1);case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),oe=function(e){le&&le.current&&le.current.focus(),R(!0);var t=window.speechSynthesis;if(t){"string"!==typeof e&&(e=n[l].es.join(", o ,"));var r=new SpeechSynthesisUtterance(e);r.pitch=1.1,r.rate=1,r.lang="es-ES";var c=speechSynthesis.getVoices().find((function(e){return"es-ES"===e.lang}));r.voice=c,t.speak(r)}else console.error("No speech syntesis API")},je=Object(c.useCallback)((function(){var e=z.toLowerCase().trim(),t=n[l].es;""!==e.trim()&&(t.map(O).includes(O(e))?(S&&(P||q)&&D<4?(B(""),M((function(e){return e+1}))):(l+1===n.length?(f(0),de()):f((function(e){return e+1})),B(""),M(0),R(!1),G(!1),re(!1),y(n[l].fr,P||q?-1:1)),le&&le.current&&le.current.focus()):R(!0))}),[l,n,z]);Object(c.useEffect)((function(){(function(){var e=Object(d.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v();case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()(),de(),ie(!1)}),[]),Object(c.useEffect)((function(){var e=function(e){"@"===e.key&&G((function(e){return!0})),"Control"===e.key&&oe(),"Enter"===e.key&&je()};return document.addEventListener("keydown",e),function(){document.removeEventListener("keydown",e)}}),[je]),Object(c.useEffect)((function(){!0===ne&&oe("\xbfD\xf3nde est\xe1 la tilde?")}),[ne]);var de=function(){var e=Object(j.a)(h);I&&(e=e.filter((function(e){return e.minimum}))),"all"!==W&&(e=e.filter((function(e){return e.module===W})));var t=g(),n=Object(j.a)(e);"error"===Y?e=e.filter((function(e){return!t.has(e.fr)||m(t.get(e.fr).attemps,t.get(e.fr).success)<80})):"error-only"===Y&&(e=e.filter((function(e){return t.has(e.fr)&&m(t.get(e.fr).attemps,t.get(e.fr).success)<80}))),0===e.length&&($("all"),e=n),f(0),B(""),G(!1),M(0),R(!1),re(!1),s(e.sort((function(){return Math.random()-.5}))),le&&le.current&&le.current.focus()};Object(c.useEffect)((function(){de()}),[W,Y,I]);var fe=function(e){B((function(t){return t+e})),le&&le.current&&le.current.focus()};if(ae)return Object(r.jsxs)("div",{className:"loader",children:[Object(r.jsx)("div",{children:"chargement..."}),Object(r.jsxs)("div",{className:"lds-ripple",children:[Object(r.jsx)("div",{}),Object(r.jsx)("div",{})]})]});var be="mainInput",he=n[l]?n[l].es.map(O):{},me=O(z);P&&(be+=" error"),P&&he.includes(me)?be+=" success":P&&he.map(p).includes(p(me))&&(be+=" warning",ne||re(!0));var Oe=n[l]?g().get(n[l].fr):{};return Object(r.jsxs)("div",{className:"App",children:[Object(r.jsxs)("div",{className:"status",children:[Object(r.jsxs)("div",{children:[l+1,"/",n.length]}),Object(r.jsx)("div",{children:Object(r.jsx)("div",{className:"btn btn-info btn-refresh",onClick:ue,children:"mettre \xe0 jour les donn\xe9es"})}),Object(r.jsxs)("div",{children:[Object(r.jsx)("div",{children:Object(r.jsxs)("select",{value:W,onChange:function(e){return X(e.target.value)},children:[Object(r.jsx)("option",{value:"all",children:"Tous les modules"},"all"),b.map((function(e){return Object(r.jsx)("option",{children:e},e)}))]})}),Object(r.jsx)("div",{children:Object(r.jsxs)("select",{value:Y,onChange:function(e){return $(e.target.value)},children:[Object(r.jsx)("option",{value:"all",children:"pas de filtre"},"all"),Object(r.jsx)("option",{value:"error",children:"nouveaux et erreurs"},"error"),Object(r.jsx)("option",{value:"error-only",children:"juste les erreurs"},"error-only")]})}),Object(r.jsxs)("div",{children:[Object(r.jsx)("input",{onChange:function(){le&&le.current&&le.current.focus(),N((function(e){return!e}))},checked:S,type:"checkbox",className:"form-check-input",id:"repeatMode"}),Object(r.jsx)("label",{className:"form-check-label",htmlFor:"repeatMode",children:"R\xe9peter en cas d'erreur"})]}),Object(r.jsxs)("div",{children:[Object(r.jsx)("input",{onChange:function(){le&&le.current&&le.current.focus(),A((function(e){return!e}))},checked:I,type:"checkbox",className:"form-check-input",id:"minVoc"}),Object(r.jsx)("label",{className:"form-check-label",htmlFor:"minVoc",children:"Juste le vocabulaire essentiel"})]})]})]}),Object(r.jsxs)("div",{style:{position:"relative"},children:[Object(r.jsx)("div",{className:"help-message",children:"Aide \xe0 la saisie, cliquez sur une lettre pour l'ajouter"}),Object(r.jsxs)("div",{className:"helper",children:[Object(r.jsx)("li",{children:Object(r.jsx)("kbd",{onClick:function(){return fe("\xf1")},children:"\xf1"})}),Object(r.jsx)("li",{children:Object(r.jsx)("kbd",{onClick:function(){return fe("\xe1")},children:"\xe1"})}),Object(r.jsx)("li",{children:Object(r.jsx)("kbd",{onClick:function(){return fe("\xf3")},children:"\xf3"})}),Object(r.jsx)("li",{children:Object(r.jsx)("kbd",{onClick:function(){return fe("\xed")},children:"\xed"})}),Object(r.jsx)("li",{children:Object(r.jsx)("kbd",{onClick:function(){return fe("\xfa")},children:"\xfa"})})]})]}),0===n.length&&Object(r.jsx)("div",{className:"center",children:"Pas de r\xe9sultats"}),n.length>0&&Object(r.jsxs)(r.Fragment,{children:[Object(r.jsxs)("div",{className:"statistics",children:[Object(r.jsx)("div",{children:n[l].es.length>1&&n[l].es.length+" possibilit\xe9s"}),S&&(q||P)&&Object(r.jsxs)("div",{children:[D,"/5"]}),Object(r.jsxs)("div",{children:[Oe?m(Oe.attemps,Oe.success)+" % de r\xe9ussite":"nouveau"," | ",n[l].module]})]}),Object(r.jsx)("div",{className:"currentWord alert alert-info",children:n[l].fr}),Object(r.jsxs)("div",{className:"input-group mb-3",style:{width:"100%"},children:[Object(r.jsx)("textarea",{ref:le,className:be,type:"text",value:z,onKeyPress:function(e){"Enter"===e.key&&(e.preventDefault(),je())},onChange:function(e){return B(e.target.value)},children:z}),Object(r.jsx)("div",{className:"input-group-append",children:Object(r.jsx)("button",{onClick:je,className:"btn btn-primary",children:"Valider"})})]}),q&&Object(r.jsx)("p",{className:"answer",children:n[l].es.join(", ")}),Object(r.jsxs)("div",{className:"solutions",children:[!q&&Object(r.jsx)("button",{className:"btn btn-danger",onClick:function(){le&&le.current.focus(),G(!0)},children:"\ud83d\udd76 Voir la r\xe9ponse"},"show"),q&&Object(r.jsx)("button",{className:"btn btn-danger",onClick:function(){l+1===n.length?f(0):f((function(e){return e+1})),B(""),G(!1),M(0),R(!1),re(!1),y(n[l].fr,-1),le&&le.current&&le.current.focus()},children:"Next"},"next"),Object(r.jsx)("button",{className:"btn btn-warning",onClick:oe,children:"\xc9couter la r\xe9ponse \ud83d\udd0a"},"read")]})]})]})};i.a.render(Object(r.jsx)(s.a.StrictMode,{children:Object(r.jsx)(k,{})}),document.getElementById("root"))},99:function(e,t){}},[[397,1,2]]]);
//# sourceMappingURL=main.438a91a1.chunk.js.map