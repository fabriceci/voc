(this["webpackJsonpilm-vocabulary-es"]=this["webpackJsonpilm-vocabulary-es"]||[]).push([[0],{211:function(e,t,n){},262:function(e,t){},264:function(e,t){},273:function(e,t){},275:function(e,t){},301:function(e,t){},302:function(e,t){},307:function(e,t){},309:function(e,t){},333:function(e,t){},397:function(e,t,n){"use strict";n.r(t);var r=n(0),c=n(10),s=n.n(c),a=n(204),i=n.n(a),l=(n(211),n(7)),o=n.n(l),u=n(18),d=n(26),j=n(68),f=n(205),b=[],h=[],p=function(e,t){return 0===t?0:Math.round(t/e*100*100)/100},O=function(e){return e?e.replaceAll("\xa1","").replaceAll("!","").replaceAll("\xbf","").replaceAll("?","").replaceAll(".","").replaceAll("\u2026","").replace(/\s\s+/g," ").trim().toLowerCase():""},m=function(e){return O(e).normalize("NFD").replace(/[\u0300-\u036f]/g,"")};function v(){return x.apply(this,arguments)}function x(){return(x=Object(j.a)(o.a.mark((function e(){var t,n,r,c,s,a,i,l,u,j=arguments;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=j.length>0&&void 0!==j[0]&&j[0],(n=JSON.parse(localStorage.getItem("words")))&&(r=localStorage.getItem("lastsync"),(c=new Date).setDate(c.getDate()-1),(!r||parseInt(r)<c.getTime())&&(n=null)),n&&!t){e.next=19;break}return(s=new f.GoogleSpreadsheet("1lA849BH1mhhAlnmhamfNnkXQVGJmEz_XpD5Fqbco5m0")).useApiKey("AIzaSyB3fhuMVnaW77F8ZiDu_mo_xJKdKzQo6tU"),e.next=8,s.loadInfo();case 8:return a=s.sheetsByIndex[0],e.next=11,a.getRows();case 11:i=e.sent,l=i.map((function(e){return{fr:e.fr?e.fr.trim():void 0,es:e.es?[e.es.trim()]:[],type:e.type?e.type.trim():void 0,module:e.module?e.module.trim():void 0}})),n=[],u=[],l.forEach((function(e){if(e.fr){var t,r,c=n.findIndex((function(t){return t.fr===e.fr}));if(-1===c)n.push(e);else if(!(t=n[c].es).includes.apply(t,Object(d.a)(e.es)))(r=n[c].es).push.apply(r,Object(d.a)(e.es));e.module&&!u.includes(e.module)&&u.push(e.module)}})),localStorage.setItem("words",JSON.stringify(n)),localStorage.setItem("modules",JSON.stringify(u)),localStorage.setItem("lastsync",JSON.stringify((new Date).getTime()));case 19:h=Object(d.a)(n),b=Object(d.a)(JSON.parse(localStorage.getItem("modules")));case 21:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var g=function(){var e=JSON.parse(localStorage.getItem("status"));return e?new Map(e):new Map},y=function(e,t){var n=g();if(n.has(e)){var r=n.get(e);r.attemps+=1,1===t?r.success+=1:r.error+=1,n.set(e,r)}else n.set(e,{attemps:1,success:1===t?1:0,error:-1===t?1:0});localStorage.setItem("status",JSON.stringify(Object(d.a)(n)))};var S=function(){var e=Object(c.useState)([]),t=Object(u.a)(e,2),n=t[0],s=t[1],a=Object(c.useState)(0),i=Object(u.a)(a,2),l=i[0],f=i[1],x=Object(c.useState)(!0),S=Object(u.a)(x,2),k=S[0],N=S[1],w=Object(c.useState)(0),C=Object(u.a)(w,2),I=C[0],A=C[1],E=Object(c.useState)(""),J=Object(u.a)(E,2),D=J[0],M=J[1],z=Object(c.useState)(!1),V=Object(u.a)(z,2),B=V[0],F=V[1],K=Object(c.useState)(!1),L=Object(u.a)(K,2),R=L[0],T=L[1],_=Object(c.useState)("all"),q=Object(u.a)(_,2),G=q[0],P=q[1],Q=Object(c.useState)("error"),U=Object(u.a)(Q,2),W=U[0],X=U[1],H=Object(c.useState)(!1),Z=Object(u.a)(H,2),Y=Z[0],$=Z[1],ee=Object(c.useRef)(null),te=function(){var e=Object(j.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s([]),localStorage.removeItem("words"),localStorage.removeItem("modules"),e.next=5,v(!0);case 5:se(G,W),ee&&ee.current.focus();case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ne=function(e){ee&&ee.current.focus(),F(!0);var t=window.speechSynthesis;if(t){"string"!==typeof e&&(e=n[l].es.join(", o ,"));var r=new SpeechSynthesisUtterance(e);r.pitch=1.1,r.rate=1,r.lang="es-ES";var c=speechSynthesis.getVoices().find((function(e){return"es-ES"===e.lang}));r.voice=c,t.speak(r)}else console.error("No speech syntesis API")},re=Object(c.useCallback)((function(){var e=D.toLowerCase().trim(),t=n[l].es;""!==e.trim()&&(t.map(O).includes(O(e))?(k&&(B||R)&&I<4?(M(""),A((function(e){return e+1}))):(l+1===n.length?(f(0),se(G,W)):f((function(e){return e+1})),M(""),A(0),F(!1),T(!1),$(!1),y(n[l].fr,B||R?-1:1)),ee&&ee.current.focus()):F(!0))}),[l,n,D]);Object(c.useEffect)((function(){(function(){var e=Object(j.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v();case 2:se("all","error");case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[]),Object(c.useEffect)((function(){var e=function(e){"@"===e.key&&T((function(e){return!0})),"Control"===e.key&&ne(),"Enter"===e.key&&re()};return document.addEventListener("keydown",e),function(){document.removeEventListener("keydown",e)}}),[re]),Object(c.useEffect)((function(){!0===Y&&ne("\xbfD\xf3nde est\xe1 la tilde?")}),[Y]);var ce=function(e){M((function(t){return t+e})),ee&&ee.current.focus()},se=function(e,t){var n=[];n="all"===e?Object(d.a)(h):h.filter((function(t){return t.module===e}));var r=g(),c=Object(d.a)(n);"error"===t?n=n.filter((function(e){return!r.has(e.fr)||p(r.get(e.fr).attemps,r.get(e.fr).success)<80})):"error-only"===t&&(n=n.filter((function(e){return r.has(e.fr)&&p(r.get(e.fr).attemps,r.get(e.fr).success)<80}))),0===n.length&&(X("all"),n=c),f(0),s(n.sort((function(){return Math.random()-.5}))),ee&&ee.current.focus()},ae=function(e,t){"module"===e?(P(t),se(t,W)):(X(t),se(G,t))};if(0===n.length)return Object(r.jsxs)("div",{className:"loader",children:[Object(r.jsx)("div",{children:"chargement..."}),Object(r.jsxs)("div",{className:"lds-ripple",children:[Object(r.jsx)("div",{}),Object(r.jsx)("div",{})]})]});var ie="mainInput",le=n[l].es.map(O),oe=O(D);B&&(ie+=" error"),B&&le.includes(oe)?ie+=" success":B&&le.map(m).includes(m(oe))&&(ie+=" warning",Y||$(!0));var ue=g().get(n[l].fr);return Object(r.jsxs)("div",{className:"App",children:[Object(r.jsxs)("div",{className:"status",children:[Object(r.jsxs)("div",{children:[l+1,"/",n.length]}),Object(r.jsx)("div",{children:Object(r.jsx)("div",{className:"btn btn-info btn-refresh",onClick:te,children:"mettre \xe0 jour les donn\xe9es"})}),Object(r.jsxs)("div",{children:[Object(r.jsx)("div",{children:Object(r.jsxs)("select",{value:G,onChange:function(e){return ae("module",e.target.value)},children:[Object(r.jsx)("option",{value:"all",children:"Tous les modules"},"all"),b.map((function(e){return Object(r.jsx)("option",{children:e},e)}))]})}),Object(r.jsx)("div",{children:Object(r.jsxs)("select",{value:W,onChange:function(e){return ae("type",e.target.value)},children:[Object(r.jsx)("option",{value:"all",children:"pas de filtre"},"all"),Object(r.jsx)("option",{value:"error",children:"nouveaux et erreurs"},"error"),Object(r.jsx)("option",{value:"error-only",children:"juste les erreurs"},"error-only")]})}),Object(r.jsxs)("div",{children:[Object(r.jsx)("input",{onChange:function(){ee&&ee.current.focus(),N((function(e){return!e}))},checked:k,type:"checkbox",className:"form-check-input",id:"repeatMode"}),Object(r.jsx)("label",{className:"form-check-label",htmlFor:"repeatMode",children:"R\xe9peter en cas d'erreur"})]})]})]}),Object(r.jsxs)("div",{style:{position:"relative"},children:[Object(r.jsx)("div",{className:"help-message",children:"Aide \xe0 la saisie, cliquez sur une lettre pour l'ajouter"}),Object(r.jsxs)("div",{className:"helper",children:[Object(r.jsx)("li",{children:Object(r.jsx)("kbd",{onClick:function(){return ce("\xf1")},children:"\xf1"})}),Object(r.jsx)("li",{children:Object(r.jsx)("kbd",{onClick:function(){return ce("\xe1")},children:"\xe1"})}),Object(r.jsx)("li",{children:Object(r.jsx)("kbd",{onClick:function(){return ce("\xf3")},children:"\xf3"})}),Object(r.jsx)("li",{children:Object(r.jsx)("kbd",{onClick:function(){return ce("\xed")},children:"\xed"})}),Object(r.jsx)("li",{children:Object(r.jsx)("kbd",{onClick:function(){return ce("\xfa")},children:"\xfa"})})]})]}),Object(r.jsxs)("div",{className:"statistics",children:[Object(r.jsx)("div",{children:n[l].es.length>1&&n[l].es.length+" possibilit\xe9s"}),k&&(R||B)&&Object(r.jsxs)("div",{children:[I,"/5"]}),Object(r.jsxs)("div",{children:[ue?p(ue.attemps,ue.success)+" % de r\xe9ussite":"nouveau"," | ",n[l].module]})]}),Object(r.jsx)("div",{className:"currentWord alert alert-info",children:n[l].fr}),Object(r.jsxs)("div",{className:"input-group mb-3",style:{width:"100%"},children:[Object(r.jsx)("textarea",{ref:ee,className:ie,type:"text",value:D,onKeyPress:function(e){"Enter"===e.key&&(e.preventDefault(),re())},onChange:function(e){return M(e.target.value)},children:D}),Object(r.jsx)("div",{className:"input-group-append",children:Object(r.jsx)("button",{onClick:re,className:"btn btn-primary",children:"Valider"})})]}),R&&Object(r.jsx)("p",{className:"answer",children:n[l].es.join(", ")}),Object(r.jsxs)("div",{className:"solutions",children:[!R&&Object(r.jsx)("button",{className:"btn btn-danger",onClick:function(){ee&&ee.current.focus(),T(!0)},children:"\ud83d\udd76 Voir la r\xe9ponse"},"show"),R&&Object(r.jsx)("button",{className:"btn btn-danger",onClick:function(){l+1===n.length?(f(0),se(G,W)):f((function(e){return e+1})),M(""),T(!1),A(0),F(!1),$(!1),y(n[l].fr,-1),ee&&ee.current.focus()},children:"Next"},"next"),Object(r.jsx)("button",{className:"btn btn-warning",onClick:ne,children:"\xc9couter la r\xe9ponse \ud83d\udd0a"},"read")]})]})};i.a.render(Object(r.jsx)(s.a.StrictMode,{children:Object(r.jsx)(S,{})}),document.getElementById("root"))},99:function(e,t){}},[[397,1,2]]]);
//# sourceMappingURL=main.b8e009d5.chunk.js.map