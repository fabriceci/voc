(this["webpackJsonpilm-vocabulary-es"]=this["webpackJsonpilm-vocabulary-es"]||[]).push([[0],{211:function(e,t,n){},262:function(e,t){},264:function(e,t){},273:function(e,t){},275:function(e,t){},301:function(e,t){},302:function(e,t){},307:function(e,t){},309:function(e,t){},333:function(e,t){},397:function(e,t,n){"use strict";n.r(t);var r=n(0),c=n(13),s=n.n(c),a=n(204),i=n.n(a),l=(n(211),n(7)),o=n.n(l),u=n(24),d=n(31),j=n(68),f=n(205),b=[],h=[],p=function(e,t){return 0===t?0:Math.round(t/e*100*100)/100},m=function(e){return e?e.replaceAll("\xa1","").replaceAll("!","").replaceAll("\xbf","").replaceAll("?","").replaceAll(".","").replaceAll("\u2026","").trim().toLowerCase():""};function O(){return v.apply(this,arguments)}function v(){return(v=Object(j.a)(o.a.mark((function e(){var t,n,r,c,s,a,i,l,u,j=arguments;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=j.length>0&&void 0!==j[0]&&j[0],(n=JSON.parse(localStorage.getItem("words")))&&(r=localStorage.getItem("lastsync"),(c=new Date).setDate(c.getDate()-1),(!r||parseInt(r)<c.getTime())&&(n=null)),n&&!t){e.next=19;break}return(s=new f.GoogleSpreadsheet("1lA849BH1mhhAlnmhamfNnkXQVGJmEz_XpD5Fqbco5m0")).useApiKey("AIzaSyB3fhuMVnaW77F8ZiDu_mo_xJKdKzQo6tU"),e.next=8,s.loadInfo();case 8:return a=s.sheetsByIndex[0],e.next=11,a.getRows();case 11:i=e.sent,l=i.map((function(e){return{fr:e.fr?e.fr.trim():void 0,es:e.es?[e.es.trim()]:[],type:e.type?e.type.trim():void 0,module:e.module?e.module.trim():void 0}})),n=[],u=[],l.forEach((function(e){if(e.fr){var t,r=n.findIndex((function(t){return t.fr===e.fr}));if(-1===r)n.push(e);else(t=n[r].es).push.apply(t,Object(d.a)(e.es));e.module&&!u.includes(e.module)&&u.push(e.module)}})),localStorage.setItem("words",JSON.stringify(n)),localStorage.setItem("modules",JSON.stringify(u)),localStorage.setItem("lastsync",JSON.stringify((new Date).getTime()));case 19:h=Object(d.a)(n),b=Object(d.a)(JSON.parse(localStorage.getItem("modules")));case 21:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var x=function(){var e=JSON.parse(localStorage.getItem("status"));return e?new Map(e):new Map},g=function(e,t){var n=x();if(n.has(e)){var r=n.get(e);r.attemps+=1,1===t?r.success+=1:r.error+=1,n.set(e,r)}else n.set(e,{attemps:1,success:1===t?1:0,error:-1===t?1:0});localStorage.setItem("status",JSON.stringify(Object(d.a)(n)))};var y=function(){var e=Object(c.useState)([]),t=Object(u.a)(e,2),n=t[0],s=t[1],a=Object(c.useState)(0),i=Object(u.a)(a,2),l=i[0],f=i[1],v=Object(c.useState)(""),y=Object(u.a)(v,2),S=y[0],k=y[1],w=Object(c.useState)(!1),N=Object(u.a)(w,2),I=N[0],C=N[1],A=Object(c.useState)(!1),E=Object(u.a)(A,2),J=E[0],D=E[1],M=Object(c.useState)("all"),z=Object(u.a)(M,2),V=z[0],B=z[1],K=Object(c.useState)("error"),L=Object(u.a)(K,2),F=L[0],T=L[1],_=Object(c.useState)(!1),q=Object(u.a)(_,2),G=q[0],P=q[1],Q=Object(c.useRef)(null),R=function(){var e=Object(j.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s([]),localStorage.removeItem("words"),localStorage.removeItem("modules"),e.next=5,O(!0);case 5:s(Object(d.a)(h).sort((function(){return Math.random()-.5})));case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),U=function(e){C(!0);var t=window.speechSynthesis;if(t){"string"!==typeof e&&(e=n[l].es.join(", o ,"));var r=new SpeechSynthesisUtterance(e);r.pitch=1.1,r.rate=1,r.lang="es-ES";var c=speechSynthesis.getVoices().find((function(e){return"es-ES"===e.lang}));r.voice=c,t.speak(r)}else console.error("No speech syntesis API")},W=Object(c.useCallback)((function(){var e=S.toLowerCase().trim(),t=n[l].es;""!==e.trim()&&(t.map(m).includes(m(e))?(f((function(e){return e+1===n.length?0:e+1})),k(""),C(!1),D(!1),P(!1),g(n[l].fr,I||J?-1:1),Q&&Q.current.focus()):C(!0))}),[l,n,S]);Object(c.useEffect)((function(){(function(){var e=Object(j.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O();case 2:H("all","error");case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[]),Object(c.useEffect)((function(){var e=function(e){"@"===e.key&&D((function(e){return!0})),"Control"===e.key&&U(),"Enter"===e.key&&W()};return document.addEventListener("keydown",e),function(){document.removeEventListener("keydown",e)}}),[W]),Object(c.useEffect)((function(){!0===G&&U("\xbfD\xf3nde est\xe1 la tilde?")}),[G]);var X=function(e){k((function(t){return t+e})),Q&&Q.current.focus()},H=function(e,t){var n=[];n="all"===e?Object(d.a)(h):h.filter((function(t){return t.module===e}));var r=x();"error"===t?n=n.filter((function(e){return!r.has(e.fr)||p(r.get(e.fr).attemps,r.get(e.fr).success)<80})):"error-only"===t&&(n=n.filter((function(e){return r.has(e.fr)&&p(r.get(e.fr).attemps,r.get(e.fr).success)<80}))),s(n.sort((function(){return Math.random()-.5})))},Z=function(e,t){"module"===e?(H(t,F),B(t)):(H(V,t),T(t))};if(0===n.length)return Object(r.jsxs)("div",{className:"loader",children:[Object(r.jsx)("div",{children:"chargement..."}),Object(r.jsxs)("div",{className:"lds-ripple",children:[Object(r.jsx)("div",{}),Object(r.jsx)("div",{})]})]});var Y="mainInput",$=n[l].es.map(m),ee=m(S);I&&(Y+=" error"),I&&$.includes(ee)?Y+=" success":I&&$.map((function(e){return m(e).normalize("NFD").replace(/[\u0300-\u036f]/g,"")})).includes(m(ee))&&(Y+=" warning",G||P(!0));var te=x().get(n[l].fr);return Object(r.jsxs)("div",{className:"App",children:[Object(r.jsxs)("div",{className:"status",children:[Object(r.jsxs)("div",{children:[l+1,"/",n.length]}),Object(r.jsx)("div",{children:Object(r.jsx)("div",{className:"btn btn-info btn-refresh",onClick:R,children:"mettre \xe0 jour les donn\xe9es"})}),Object(r.jsxs)("div",{children:[Object(r.jsx)("div",{children:Object(r.jsxs)("select",{value:V,onChange:function(e){return Z("module",e.target.value)},children:[Object(r.jsx)("option",{value:"all",children:"Tous les modules"},"all"),b.map((function(e){return Object(r.jsx)("option",{children:e},e)}))]})}),Object(r.jsx)("div",{children:Object(r.jsxs)("select",{value:F,onChange:function(e){return Z("type",e.target.value)},children:[Object(r.jsx)("option",{value:"all",children:"pas de filtre"},"all"),Object(r.jsx)("option",{value:"error",children:"nouveaux et erreurs"},"error"),Object(r.jsx)("option",{value:"error-only",children:"juste les erreurs"},"error-only")]})})]})]}),Object(r.jsxs)("div",{style:{position:"relative"},children:[Object(r.jsx)("div",{className:"help-message",children:"Aide \xe0 la saisie, cliquez sur une lettre pour l'ajouter"}),Object(r.jsxs)("div",{className:"helper",children:[Object(r.jsx)("li",{children:Object(r.jsx)("kbd",{onClick:function(){return X("\xf1")},children:"\xf1"})}),Object(r.jsx)("li",{children:Object(r.jsx)("kbd",{onClick:function(){return X("\xe1")},children:"\xe1"})}),Object(r.jsx)("li",{children:Object(r.jsx)("kbd",{onClick:function(){return X("\xf3")},children:"\xf3"})}),Object(r.jsx)("li",{children:Object(r.jsx)("kbd",{onClick:function(){return X("\xed")},children:"\xed"})}),Object(r.jsx)("li",{children:Object(r.jsx)("kbd",{onClick:function(){return X("\xfa")},children:"\xfa"})})]})]}),Object(r.jsxs)("div",{className:"statistics",children:[Object(r.jsx)("div",{children:n[l].es.length>1&&n[l].es.length+" possibilit\xe9s"}),Object(r.jsxs)("div",{children:[te?p(te.attemps,te.success)+" % de r\xe9ussite":"nouveau"," | ",n[l].module]})]}),Object(r.jsx)("div",{className:"currentWord alert alert-info",children:n[l].fr}),Object(r.jsxs)("div",{className:"input-group mb-3",style:{width:"100%"},children:[Object(r.jsx)("textarea",{ref:Q,className:Y,type:"text",value:S,onKeyPress:function(e){"Enter"===e.key&&(e.preventDefault(),W())},onChange:function(e){return k(e.target.value)},children:S}),Object(r.jsx)("div",{className:"input-group-append",children:Object(r.jsx)("button",{onClick:W,className:"btn btn-primary",children:"Valider"})})]}),J&&Object(r.jsx)("p",{className:"answer",children:n[l].es.join(", ")}),Object(r.jsxs)("div",{className:"solutions",children:[!J&&Object(r.jsx)("button",{className:"btn btn-danger",onClick:function(){return D(!0)},children:"\ud83d\udd76 Voir la r\xe9ponse"},"show"),J&&Object(r.jsx)("button",{className:"btn btn-danger",onClick:function(){f((function(e){return e+1===n.length?0:e+1})),k(""),D(!1),C(!1),P(!1),g(n[l].fr,-1),Q&&Q.current.focus()},children:"Next"},"next"),Object(r.jsx)("button",{className:"btn btn-warning",onClick:U,children:"\xc9couter la r\xe9ponse \ud83d\udd0a"},"read")]})]})};i.a.render(Object(r.jsx)(s.a.StrictMode,{children:Object(r.jsx)(y,{})}),document.getElementById("root"))},99:function(e,t){}},[[397,1,2]]]);
//# sourceMappingURL=main.c52babef.chunk.js.map